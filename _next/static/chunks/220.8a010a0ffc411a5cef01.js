(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{220:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return T}});var r=n(5893),o=n(809),u=n.n(o);function a(t,e,n,r,o,u,a){try{var i=t[u](a),c=i.value}catch(l){return void n(l)}i.done?e(c):Promise.resolve(c).then(r,o)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var u=t.apply(e,n);function i(t){a(u,r,o,i,c,"next",t)}function c(t){a(u,r,o,i,c,"throw",t)}i(void 0)}))}}n(5152),n(4593);var c=n(7294);const l=(0,c.createContext)(null),s=l.Provider;function f(){const t=(0,c.useContext)(l);if(null==t)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function p(){return f().map}var d=n(5243);function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function y(t){let{children:e,className:n,id:r,placeholder:o,style:u,whenCreated:a,...i}=t;const l=(0,c.useRef)(null),f=function(t,e){const[n,r]=(0,c.useState)(null);return(0,c.useEffect)((()=>{if(null!==t.current&&null===n){const n=new d.Map(t.current,e);null!=e.center&&null!=e.zoom?n.setView(e.center,e.zoom):null!=e.bounds&&n.fitBounds(e.bounds,e.boundsOptions),null!=e.whenReady&&n.whenReady(e.whenReady),r(n)}}),[t,n,e]),n}(l,i),p=(0,c.useRef)(!1);(0,c.useEffect)((()=>{null!=f&&!1===p.current&&null!=a&&(p.current=!0,a(f))}),[f,a]),(0,c.useEffect)((()=>()=>{null==f||f.remove()}),[f]);const[y]=(0,c.useState)({className:n,id:r,style:u}),h=(0,c.useMemo)((()=>f?{__version:1,map:f}:null),[f]),v=h?c.createElement(s,{value:h},e):o??null;return c.createElement("div",m({},y,{ref:l}),v)}n(3935);function h(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function v(t){return function(e){const n=f(),r=t(h(e,n),n);return function(t,e){const n=(0,c.useRef)(e);(0,c.useEffect)((function(){e!==n.current&&null!=t.attributionControl&&(null!=n.current&&t.attributionControl.removeAttribution(n.current),null!=e&&t.attributionControl.addAttribution(e)),n.current=e}),[t,e])}(n.map,e.attribution),function(t,e){const n=(0,c.useRef)();(0,c.useEffect)((function(){return null!=e&&t.instance.on(e),n.current=e,function(){null!=n.current&&t.instance.off(n.current),n.current=null}}),[t,e])}(r.current,e.eventHandlers),function(t,e){(0,c.useEffect)((function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var n;null==(n=e.layerContainer)||n.removeLayer(t.instance),e.map.removeLayer(t.instance)}}),[e,t])}(r.current,n),r}}const g=function(t){function e(e,n){const{instance:r}=t(e).current;return(0,c.useImperativeHandle)(n,(()=>r)),null}return(0,c.forwardRef)(e)}(v(function(t,e){return null==e?function(e,n){return(0,c.useRef)(t(e,n))}:function(n,r){const o=(0,c.useRef)(t(n,r)),u=(0,c.useRef)(n),{instance:a}=o.current;return(0,c.useEffect)((function(){u.current!==n&&(e(a,n,u.current),u.current=n)}),[a,n,r]),o}}((function(t,e){let{url:n,...r}=t;return{instance:new d.TileLayer(n,h(r,e)),context:e}}),(function(t,e,n){const{opacity:r,zIndex:o}=e;null!=r&&r!==n.opacity&&t.setOpacity(r),null!=o&&o!==n.zIndex&&t.setZIndex(o)}))));function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,a=!0,i=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){i=!0,u=t},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw u}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var k=function(){var t=i(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,t.next=5,n.text();case 5:return r=t.sent,t.abrupt("return",(new window.DOMParser).parseFromString(r,"text/xml"));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=i(u().mark((function t(e,n){var r,o,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=x(e),t.prev=1,a=u().mark((function t(){var e,r,a,i,c,l,s,f,p,d,m,y,h,v,g,b,x,A,E,S,N,O,C,T,_;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.value,t.next=3,k(e);case 3:for(r=t.sent,a={},i={},c=[],l=r.getElementsByTagName("node"),s=0;s<l.length;s++)f=l[s],a[f.getAttribute("id")]=[parseFloat(f.getAttribute("lat")),parseFloat(f.getAttribute("lon"))];for(p=r.getElementsByTagName("way"),d=0;d<p.length;d++){for(m=p[d],y=[],h=m.getElementsByTagName("nd"),v=0;v<h.length;v++)y.push(a[h[v].getAttribute("ref")]);i[m.getAttribute("id")]={nodes:y,oldName:m.querySelector('tag[k="owner_1809"]')?m.querySelector('tag[k="owner_1809"]').getAttribute("v"):""}}for(g=r.getElementsByTagName("relation"),b=0;b<g.length;b++){for(x=g[b],A=x.getElementsByTagName("member"),E=[],S=[],N=0;N<A.length;N++)"way"===(O=A[N]).getAttribute("type")&&(C=O.getAttribute("ref"),"outer"===O.getAttribute("role")?E.push.apply(E,w(i[C].nodes)):"inner"===O.getAttribute("role")&&S.push.apply(S,w(i[C].nodes)));T=x.querySelector('tag[k="owner_1809"]')?x.querySelector('tag[k="owner_1809"]').getAttribute("v"):"",c.push({outer:E,inner:S,oldName:T})}_=function(t){return t.length>0&&t[0]!==t[t.length-1]&&t.push(t[0]),t},Object.values(i).forEach((function(t){var e=_(t.nodes);if(e.length<3)console.error("Invalid polygon: ",e);else{var r=L.polygon(e.map((function(t){return[t[0],t[1]]})),{color:"#ff7800",fillColor:"#ff7800",fillOpacity:.5}).addTo(n);t.oldName&&r.bindTooltip(t.oldName,{permanent:!1,direction:"top"})}})),c.forEach((function(t){var e=L.polygon(_(t.outer.map((function(t){return[t[0],t[1]]}))),{color:"#ff7800",fillColor:"#ff7800",fillOpacity:.5}).addTo(n);if(t.oldName&&e.bindTooltip(t.oldName,{permanent:!1,direction:"top"}),t.inner.length>0){var r=L.polygon(_(t.inner.map((function(t){return[t[0],t[1]]}))),{color:"#ff7800",fillOpacity:.5}).addTo(n);t.oldName&&r.bindTooltip(t.oldName,{permanent:!1,direction:"top"})}}));case 16:case"end":return t.stop()}}),t)})),r.s();case 4:if((o=r.n()).done){t.next=8;break}return t.delegateYield(a(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),r.e(t.t1);case 13:return t.prev=13,r.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})));return function(e,n){return t.apply(this,arguments)}}(),S=[30.12511001,59.88747679,30.46576637,60.0010745],N=[[S[1],S[0]],[S[3],S[2]]],O=function(){var t=i(u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/files");case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Network response was not ok");case 5:return t.next=7,e.json();case 7:return n=t.sent,t.abrupt("return",n.map((function(t){return"/data/".concat(t)})));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=function(){console.log("XMLLayer");var t=p(),e=(0,c.useState)([]),n=e[0],r=e[1];return(0,c.useEffect)((function(){(function(){var t=i(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:e=t.sent,r(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),(0,c.useEffect)((function(){n.length>0&&E(n,t)}),[n,t]),null},T=function(){return(0,r.jsxs)(y,{bounds:N,style:{height:"100vh",width:"100%"},zoom:17,minZoom:17,maxZoom:19,children:[(0,r.jsx)(g,{url:"https://tiles.stadiamaps.com/tiles/stamen_toner_background/{z}/{x}/{y}{r}.{ext}",attribution:'\xa9 <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> \xa9 <a href="https://www.stamen.com/" target="_blank">Stamen Design</a> \xa9 <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> \xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',ext:"png"}),(0,r.jsx)(C,{})]})}},4593:function(){}}]);